sudo: required
language: python
services:
- docker
before_install:
- docker pull smintz/nomadgen-builder
install:
- pip install --upgrade pycodestyle
script:
- docker run --privileged -v /home/travis/build/smintz/nomadgen:/work smintz/nomadgen-builder
  /bin/bash -c "cd /work; pip install setuptools && make deps && make test"
- pycodestyle --exclude=constants.py,ttypes.py nomadgen
- docker run --privileged -v /home/travis/build/smintz/nomadgen:/work smintz/nomadgen-builder
  /bin/bash -c "cd /work; pip install setuptools && make deps && make pex"
deploy:
  provider: releases
  api_key:
    secure: "iVOZ4ZZBh1+xOvGiOWOef7sUfOvTRYvInkSicx9kpV4WmmuoEGTTNKkksorSiJmMB/vkjg7K5w5vs9sai3xHu9SVk6PlyblBNvxWvAcik0kSP2N2ozJE9X+fvjLs7GQzIHxOnIC//KHoUHQiG9zCtYxJHPfj2JUbQuUiXGlereamGI5fA79m2pwhLOkkLoIYh3JbNsDbT0wA5tMKNxYaITyDIJlMCPqgwFWfiQ/HHD/Hb38CR1NY99lK82kidXpAOylt9dTxWV1hSf57IzKqdsvkW60jRupgAIPW2+oiVCdqREdB6EEy9cPu6orK8CU3dpJSpIXqlhSFvMdcctn+xv6S1xiufTIstHqd16Bka/1kYER4XwmRjKRe4iJJy/f43nEs5IIyoxzK2Y3hHEYAD4J521d3/kXQeCq0cFThNnjRozT6fRs3keQbWdP4krJKcqNwUyQX69AMmRouLRL3rRlFWUID2HGG5wx28I1FYgPYFyECx8gpJFdv1vppUJ+Y5Cnt+daxJdmoxdAU/Ou9mrzZqm35waWABtOJjeV0gkCjrRCeWztswLSRtq+pFRW2CQyn9fc7+/f/3IEoIWW6KL/ZjYcK4ab6YdmScDTUlWuEyZ9UbvXb6ua8z+V8H1kRQmeFVJkWiXaMqHmbnHRZ6cIvbc0NZ2Y/Cm3623vU+68="
  file: "./build/nomadgen.pex"
  on:
    tags: true
